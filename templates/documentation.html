<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Documentation - Flood Early Warning System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; position: relative; }
        .back-btn { position: absolute; top: 20px; left: 20px; background: white; color: #667eea; padding: 10px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; }
        h1 { font-size: 2.5em; margin-bottom: 10px; }
        .subtitle { font-size: 1.1em; opacity: 0.9; }
        .badge { display: inline-block; background: rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 20px; margin: 5px; font-size: 0.9em; }
        nav { background: #f5f7fa; padding: 20px 40px; border-bottom: 3px solid #667eea; position: sticky; top: 0; z-index: 100; }
        nav ul { list-style: none; display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        nav a { color: #667eea; text-decoration: none; font-weight: 600; padding: 5px 10px; border-radius: 5px; }
        nav a:hover { background: #667eea; color: white; }
        .content { padding: 40px; line-height: 1.8; }
        section { margin-bottom: 60px; }
        h2 { color: #667eea; font-size: 2em; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 3px solid #667eea; }
        h3 { color: #764ba2; font-size: 1.5em; margin: 30px 0 15px 0; }
        p { margin-bottom: 15px; color: #444; }
        ul, ol { margin-left: 30px; margin-bottom: 20px; }
        li { margin-bottom: 10px; color: #444; }
        code { background: #f5f7fa; padding: 2px 8px; border-radius: 4px; font-family: 'Courier New', monospace; color: #d63384; }
        pre { background: #2d2d2d; color: #f8f8f2; padding: 20px; border-radius: 10px; overflow-x: auto; margin: 20px 0; font-family: 'Courier New', monospace; line-height: 1.5; }
        pre code { background: transparent; color: #f8f8f2; padding: 0; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden; }
        thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        th { padding: 15px; text-align: left; font-weight: 600; }
        td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
        tbody tr:hover { background: #f5f7fa; }
        .info-box { background: #e0f7fa; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #00acc1; }
        .success-box { background: #e8f5e9; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid #4caf50; }
        .stats-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
        .stat-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px 20px; border-radius: 12px; text-align: center; }
        .stat-number { font-size: 2.5em; font-weight: bold; margin-bottom: 10px; }
        .stat-label { font-size: 0.9em; opacity: 0.9; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 30px; border-radius: 8px; text-decoration: none; display: inline-block; margin: 10px; font-weight: 600; }
        footer { background: #2d2d2d; color: white; padding: 30px; text-align: center; }
    </style>
</head>
<body>
<div class="container">
    <header>
        <a href="/" class="back-btn">â† Back to App</a>
        <h1>ğŸŒ§ï¸ Flood Early Warning System</h1>
        <p class="subtitle">Technical Documentation â€” LSTM Rainfall Forecasting + Fuzzy Logic Risk</p>
        <div>
            <span class="badge">Version 2.0</span>
            <span class="badge">Python 3.10</span>
            <span class="badge">TensorFlow/Keras</span>
            <span class="badge">Flask</span>
            <span class="badge">Fuzzy Logic (Mamdani)</span>
        </div>
    </header>

    <nav>
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#architecture">Architecture</a></li>
            <li><a href="#model">LSTM Model</a></li>
            <li><a href="#fuzzy">Fuzzy Logic</a></li>
            <li><a href="#api">API Docs</a></li>
            <li><a href="#simulation">Simulation</a></li>
            <li><a href="#usage">Usage</a></li>
        </ul>
    </nav>

    <div class="content">

        <section id="overview">
            <h2>ğŸ“‹ System Overview</h2>
            <p>An AI-powered flood early warning system combining an LSTM neural network for 3-hour rainfall forecasting with a Mamdani fuzzy logic engine for risk assessment. Produces colour-coded flood risk alerts from simple weather inputs.</p>
            <div class="stats-container">
                <div class="stat-box"><div class="stat-number">19</div><div class="stat-label">Model Features</div></div>
                <div class="stat-box"><div class="stat-number">3h</div><div class="stat-label">Forecast Horizon</div></div>
                <div class="stat-box"><div class="stat-number">18</div><div class="stat-label">Forecast Steps</div></div>
                <div class="stat-box"><div class="stat-number">4</div><div class="stat-label">Risk Levels</div></div>
            </div>
            <ul>
                <li>âœ… LSTM forecasts 3 hours of rainfall in 18 x 10-min steps</li>
                <li>âœ… Mamdani fuzzy logic converts forecast to flood risk confidence (0-100%)</li>
                <li>âœ… Colour-coded alerts: Green / Yellow / Orange / Red</li>
                <li>âœ… Simulation mode for custom rainfall scenario testing</li>
                <li>âœ… Auto-roll feeds previous forecast back into rain history</li>
                <li>âœ… Local model â€” no internet required after setup</li>
            </ul>
            <div class="info-box">
                <strong>Live App:</strong> <a href="https://ict-306.onrender.com">https://ict-306.onrender.com</a> |
                <strong>GitHub:</strong> <a href="https://github.com/diyanashamil/ict-306">github.com/diyanashamil/ict-306</a>
            </div>
        </section>

        <section id="architecture">
            <h2>ğŸ—ï¸ System Architecture</h2>
            <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER BROWSER                        â”‚
â”‚   index.html â†’ Enter weather values â†’ Click Predict     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP POST /predict
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FLASK BACKEND (rainfall_prediction.py)          â”‚
â”‚                                                         â”‚
â”‚  /predict â†’ LSTM Model â†’ 18-step forecast series        â”‚
â”‚           â†’ Fuzzy Logic â†’ Risk score + Alert Level      â”‚
â”‚  /save    â†’ Append to data/input.csv                    â”‚
â”‚  /docs    â†’ documentation.html                         â”‚
â”‚  /data    â†’ data_view.html                             â”‚
â”‚  /api/data â†’ JSON paginated data                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

File Structure:
ict-306/
â”œâ”€â”€ rainfall_prediction.py     â† Main app
â”œâ”€â”€ models/
â”‚   â””â”€â”€ rainfall_model.keras   â† LSTM model (local)
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ index.html             â† Main UI
â”‚   â”œâ”€â”€ documentation.html     â† This page
â”‚   â””â”€â”€ data_view.html         â† Data viewer
â””â”€â”€ data/
    â”œâ”€â”€ weather_data.csv       â† Training data
    â”œâ”€â”€ input.csv              â† Saved inputs
    â”œâ”€â”€ observed_rain.csv      â† Auto-roll history (auto-created)
    â””â”€â”€ last_forecast.json     â† Previous forecast (auto-created)</pre>

            <h3>Technology Stack</h3>
            <table>
                <thead><tr><th>Technology</th><th>Purpose</th></tr></thead>
                <tbody>
                    <tr><td>Python 3.10</td><td>Backend language</td></tr>
                    <tr><td>Flask</td><td>Web framework</td></tr>
                    <tr><td>TensorFlow/Keras</td><td>LSTM model inference</td></tr>
                    <tr><td>NumPy / Pandas</td><td>Data processing</td></tr>
                    <tr><td>Scikit-learn</td><td>MinMaxScaler normalisation</td></tr>
                    <tr><td>Render</td><td>Cloud hosting</td></tr>
                </tbody>
            </table>
        </section>

        <section id="model">
            <h2>ğŸ¤– LSTM Model</h2>
            <ul>
                <li><strong>Type:</strong> LSTM (Long Short-Term Memory) Neural Network</li>
                <li><strong>Input Shape:</strong> (1, 19, 19) â€” 1 sample Ã— 19 timesteps Ã— 19 features</li>
                <li><strong>Output:</strong> Single rainfall value (mm) expanded to 18-step forecast series</li>
                <li><strong>File:</strong> <code>models/rainfall_model.keras</code> loaded locally at startup</li>
            </ul>

            <h3>19 Input Features</h3>
            <table>
                <thead><tr><th>Symbol</th><th>Description</th><th>Unit</th><th>Valid Range</th></tr></thead>
                <tbody>
                    <tr><td>T</td><td>Temperature</td><td>Â°C</td><td>-10 to 60</td></tr>
                    <tr><td>rh</td><td>Relative Humidity</td><td>%</td><td>0 to 100</td></tr>
                    <tr><td>p</td><td>Atmospheric Pressure</td><td>hPa</td><td>850 to 1100</td></tr>
                    <tr><td>wv</td><td>Wind Velocity</td><td>m/s</td><td>0 to 60</td></tr>
                    <tr><td>max. wv</td><td>Max Wind Velocity</td><td>m/s</td><td>0 to 100</td></tr>
                    <tr><td>raining</td><td>Is it raining?</td><td>â€”</td><td>0 or 1</td></tr>
                    <tr><td>Tpot, Tdew</td><td>Potential/Dew point temp</td><td>K / Â°C</td><td>â€”</td></tr>
                    <tr><td>VPmax, VPact, VPdef</td><td>Vapour pressure values</td><td>hPa</td><td>â€”</td></tr>
                    <tr><td>sh, H2OC</td><td>Specific humidity / H2O concentration</td><td>g/kg</td><td>â€”</td></tr>
                    <tr><td>rho</td><td>Air density</td><td>g/mÂ³</td><td>â€”</td></tr>
                    <tr><td>wd</td><td>Wind direction</td><td>Â°</td><td>0 to 360</td></tr>
                    <tr><td>rain</td><td>Current rainfall</td><td>mm</td><td>â€”</td></tr>
                    <tr><td>SWDR, PAR</td><td>Solar/photosynthetic radiation</td><td>W/mÂ²</td><td>â€”</td></tr>
                    <tr><td>Tlog</td><td>Log temperature</td><td>â€”</td><td>â€”</td></tr>
                </tbody>
            </table>
        </section>

        <section id="fuzzy">
            <h2>ğŸ§  Fuzzy Logic Risk Engine (Mamdani)</h2>
            <p>The Mamdani fuzzy inference system converts the LSTM forecast into a human-readable flood risk level using linguistic rules.</p>

            <h3>Fuzzy Inputs</h3>
            <table>
                <thead><tr><th>Input</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td>forecast_total</td><td>Sum of 18-step forecast (mm total over 3 hours)</td></tr>
                    <tr><td>forecast_peak</td><td>Highest single 10-min value in forecast</td></tr>
                    <tr><td>step_delta</td><td>Current peak minus previous call peak (trend direction)</td></tr>
                </tbody>
            </table>

            <h3>Sample Rules</h3>
            <pre>IF total is HIGH AND peak is HIGH â†’ risk is HIGH
IF total is HIGH AND (peak is MED OR delta is UP) â†’ risk is HIGH
IF total is MED AND peak is MED â†’ risk is MEDIUM
IF total is LOW AND peak is LOW â†’ risk is LOW
IF delta is DOWN AND total is LOW â†’ risk is LOW</pre>

            <h3>Risk Output Levels</h3>
            <table>
                <thead><tr><th>Score</th><th>Alert</th><th>Meaning</th></tr></thead>
                <tbody>
                    <tr><td>0.00 â€“ 0.29</td><td>ğŸŸ¢ Green</td><td>Low risk â€” safe conditions</td></tr>
                    <tr><td>0.30 â€“ 0.54</td><td>ğŸŸ¡ Yellow</td><td>Moderate risk â€” stay alert</td></tr>
                    <tr><td>0.55 â€“ 0.79</td><td>ğŸŸ  Orange</td><td>High risk â€” prepare action</td></tr>
                    <tr><td>0.80 â€“ 1.00</td><td>ğŸ”´ Red</td><td>Severe risk â€” flood emergency</td></tr>
                </tbody>
            </table>
        </section>

        <section id="api">
            <h2>ğŸ“¡ API Documentation</h2>

            <h3>POST /predict â€” Flood Risk Prediction</h3>
            <pre>// Request body
{
  "T": 28.5, "rh": 85, "p": 1008,
  "wv": 4.2, "max. wv": 7.8, "raining": 1,
  "auto_roll": true, "simulation_mode": false
}

// Response
{
  "mode": "model",
  "risk_engine": "fuzzy_mamdani",
  "alert_level": "Orange",
  "flood_risk_confidence": 0.68,
  "forecast_total_mm": 12.4,
  "forecast_peak_mm_per_step": 0.69,
  "forecast_series_mm": [0.69, 0.69, ...],
  "forecast_horizon_hours": 3.0,
  "explanation": ["Forecast accumulation: 12.40mm", ...]
}</pre>

            <h3>POST /save â€” Save Observed Input</h3>
            <p>Appends current weather input to <code>data/input.csv</code></p>

            <h3>POST /bulk_upload â€” Upload Simulation Scenario</h3>
            <pre>{ "rain_series": [0.2, 0.5, 1.2, 2.6, 4.2, 5.0, ...], "overwrite": true }</pre>

            <h3>POST /bulk_reset â€” Reset Scenario Cursor</h3>
            <p>Resets simulation cursor to step 0 (keeps bulk_save.csv intact)</p>

            <h3>POST /reset_auto_history â€” Clear Rain History</h3>
            <p>Deletes <code>observed_rain.csv</code> and <code>last_forecast.json</code> for a fresh start</p>

            <h3>GET /api/data â€” Paginated Data</h3>
            <pre>GET /api/data?page=1&per_page=10
â†’ { "data": [...], "total": 50, "page": 1, "total_pages": 5 }</pre>
        </section>

        <section id="simulation">
            <h2>ğŸ® Simulation Mode</h2>
            <p>Bypasses the LSTM model and uses a custom rainfall series as the forecast â€” useful for testing fuzzy logic with known scenarios.</p>

            <ol>
                <li>Paste 18 comma-separated rainfall values (mm per 10-min)</li>
                <li>Click <strong>Upload Scenario (overwrite)</strong></li>
                <li>Tick <strong>Enable Simulation Mode</strong></li>
                <li>Click <strong>Predict Flood Risk</strong></li>
                <li>Each prediction advances the cursor by 1 step</li>
            </ol>

            <h3>Example â€” Heavy Rain Scenario</h3>
            <pre>0.2,0.3,0.5,0.8,1.2,1.8,2.6,3.4,4.2,4.8,5.0,5.0,4.8,4.5,4.1,3.6,3.0,2.4</pre>
            <div class="success-box">
                <strong>Expected result:</strong> Total â‰ˆ 52mm, Peak = 5mm/10min â†’ Alert Level: Red, Risk â‰ˆ 83%
            </div>
        </section>

        <section id="usage">
            <h2>ğŸ“– Usage Guide</h2>
            <ol>
                <li>Enter Temperature, Humidity, Pressure, Wind Speed, Max Wind, Raining (0/1)</li>
                <li>Click <strong>Predict Flood Risk</strong> to get AI forecast + risk level</li>
                <li>Optionally click <strong>Save Observed Input</strong> to log the data</li>
                <li>Click <strong>View Saved Data</strong> to see historical entries</li>
                <li>Use <strong>Reset Auto History</strong> to start fresh prediction cycle</li>
            </ol>

            <div class="info-box">
                <strong>Local run:</strong>
                <pre style="margin-top:10px;">source venv/bin/activate
PORT=8080 python rainfall_prediction.py
# Open: http://localhost:8080</pre>
            </div>

            <div style="text-align:center; margin-top:30px;">
                <a href="/" class="btn-primary">ğŸ  Back to App</a>
                <a href="/data" class="btn-primary">ğŸ“Š View Saved Data</a>
                <a href="https://github.com/diyanashamil/ict-306" class="btn-primary" target="_blank">ğŸ’» GitHub</a>
            </div>
        </section>

    </div>

    <footer>
        <p><strong>Flood Early Warning System</strong> â€” Technical Documentation v2.0</p>
        <p>February 2026 | Murdoch University Singapore | ICT 306</p>
    </footer>
</div>
</body>
</html>